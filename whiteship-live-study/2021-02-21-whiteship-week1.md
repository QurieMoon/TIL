# 1ì£¼ì°¨ ê³¼ì œ: JVMì€ ë¬´ì—‡ì´ë©° ìë°” ì½”ë“œëŠ” ì–´ë–»ê²Œ ì‹¤í–‰í•˜ëŠ” ê²ƒì¸ê°€ \#1

## ëª©í‘œ

- ìë°” ì†ŒìŠ¤ íŒŒì¼(.java)ì„ JVMìœ¼ë¡œ ì‹¤í–‰í•˜ëŠ” ê³¼ì • ì´í•´í•˜ê¸°.

## í•™ìŠµí•  ê²ƒ

- [JVMì´ë€ ë¬´ì—‡ì¸ê°€](#JVMì´ë€-ë¬´ì—‡ì¸ê°€)
- [ì»´íŒŒì¼ í•˜ëŠ” ë°©ë²•](#ì»´íŒŒì¼-í•˜ëŠ”-ë°©ë²•)
- [ì‹¤í–‰í•˜ëŠ” ë°©ë²•](#ì‹¤í–‰í•˜ëŠ”-ë°©ë²•)
- [ë°”ì´íŠ¸ì½”ë“œë€ ë¬´ì—‡ì¸ê°€](#ë°”ì´íŠ¸ì½”ë“œë€-ë¬´ì—‡ì¸ê°€)
- [JIT ì»´íŒŒì¼ëŸ¬ë€ ë¬´ì—‡ì´ë©° ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€](#JIT-ì»´íŒŒì¼ëŸ¬ë€-ë¬´ì—‡ì´ë©°-ì–´ë–»ê²Œ-ë™ì‘í•˜ëŠ”ì§€)
- [JDKì™€ JREì˜ ì°¨ì´](#JDKì™€-JREì˜-ì°¨ì´)

## í•™ìŠµ ë‚´ìš©

- JVMì´ë€ ë¬´ì—‡ì¸ê°€

  - JVM(Java virtual Machine)ì€ ìë°” ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ í”„ë¡œê·¸ë¨ìœ¼ë¡œ,
    ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ ì‹¤í–‰í•œë‹¤.

    - JVMì€ ë¦¬ëˆ…ìŠ¤, ìœˆë„ìš° ë“± OS ë¿ë§Œ ì•„ë‹ˆë¼, IE ë“±ì˜ ì›¹ ë¸Œë¼ìš°ì €ì—ë„ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•˜ë©°,
      íœ´ëŒ€ì „í™”ë‚˜ ê°€ì „ê¸°ê¸°ì—ë„ ì„¤ì¹˜ ê°€ëŠ¥í•˜ë‹¤.

    - JVMì´ ìˆ˜í–‰í•˜ëŠ” ì‘ì—…

      1) ì½”ë“œ ë¡œë”©

      2) ì½”ë“œ ê²€ì¦

      3) ì½”ë“œ ì‹¤í–‰

      4) ì‹¤í–‰ í™˜ê²½(runtime environment) ì œê³µ

  - ì¼ë°˜ì ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš°, ì•„ë˜ì™€ ê°™ì´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì½”ë“œëŠ” OSë§Œ ê±°ì¹˜ê³  í•˜ë“œì›¨ì–´ì— ì „ë‹¬ëœë‹¤.

    ![normal-app-architecture](./images/normal_app_architecture.png)

    í•˜ì§€ë§Œ, java ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš°, jvmì„ ê±°ì¹œ í›„ì— OSë¥¼ ê±°ì³ì„œ í•˜ë“œì›¨ì–´ ì „ë‹¬ëœë‹¤.

    ![java-app-architecture](./images/java_app_architecture.png)

  - ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì¡Œì„ ë•Œ, ì¥ì ê³¼ ë‹¨ì ì€ ì•„ë˜ì™€ ê°™ë‹¤.

    - ì¥ì 

      1) OSì™€ í•˜ë“œì›¨ì–´ì— ë…ë¦½ì ì´ë‹¤.

      - java ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš°, í•­ìƒ jvm ìœ„ì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— OS/í•˜ë“œì›¨ì–´ì— êµ¬ì• ë°›ì§€ ì•ŠëŠ”ë‹¤.

    - ë‹¨ì 

      1) ìë°” ì–´í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œê°€ í•˜ë“œì›¨ì–´ì— ë§ê²Œ ì™„ì „íˆ ì»´íŒŒì¼ëœ ìƒíƒœê°€ ì•„ë‹ˆë¼, ì‹¤í–‰ ì‹œì— í•´ì„(interpret) ë˜ê¸° ë•Œë¬¸ì— ì†ë„ê°€ ëŠë¦¬ë‹¤.

      --> ì´ ë¶€ë¶„ì˜ ê²½ìš°, JIT ì»´íŒŒì¼ëŸ¬ì™€ ìµœì í™” ê¸°ìˆ ì˜ í–¥ìƒìœ¼ë¡œ ë§ì´ ê°œì„ ë˜ì—ˆë‹¤.

- ì»´íŒŒì¼ í•˜ëŠ” ë°©ë²•

  - ëª…ë ¹ì–´ë¡œ ìë°” ì†ŒìŠ¤ì½”ë“œ ì»´íŒŒì¼ í•˜ëŠ” ë°©ë²•

    ```shell
    javac YouSouceFile.java
    ```

    --> ìœ„ì™€ ê°™ì´ ìë°” ì†ŒìŠ¤ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ë©´ `.class` ë¼ëŠ” í™•ì¥ìë¥¼ ê°€ì§„ ìë°” ë°”ì´íŠ¸ì½”ë“œ íŒŒì¼ì„ ì–»ê²Œ ëœë‹¤.

- ì‹¤í–‰í•˜ëŠ” ë°©ë²•

  - ëª…ë ¹ì–´ë¡œ ìë°” í”„ë¡œê·¸ë¨ ì‹¤í–‰í•˜ëŠ” ë°©ë²•

    - ì»´íŒŒì¼ëœ ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ ì‹¤í–‰í•œë‹¤.

      ```
      java YourClassName
      ```

  - ì»´íŒŒì¼ì´ ì™„ë£Œëœ ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²Œ ë°”ë¡œ JVMì´ë‹¤.
    ì•„ë˜ ê·¸ë¦¼ì„ ë³´ì.

    

    ![jvm_overall_architecture](./images/jvm_overall_architecture.png)

    > ê·¸ë¦¼ ì¶œì²˜: [dnjscksdn98.log - [Java] What is JVM?](https://velog.io/@dnjscksdn98/Java-What-is-JVM)

    --> ìë°” ì»´íŒŒì¼ëŸ¬ë¡œ ì»´íŒŒì¼ ì™„ë£Œëœ ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`) ëŠ” jvmì— ì˜í•´ì„œ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ê³ , ì‹¤í–‰ëœë‹¤.

    ì´ ìì„¸í•œ ê³¼ì •ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ì„œ jvmì˜ êµ¬ì„± ìš”ì†Œë¥¼ ìì„¸íˆ ì‚´í´ë³´ì.

  - ìë°” ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” JVMì˜ êµ¬ì„± ìš”ì†Œ

    1) Class Loader

    - ìë°” ì»´íŒŒì¼ì˜ ê²°ê³¼ë¬¼ì¸ ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ Runtime Data Area í˜•íƒœë¡œ ë©”ëª¨ë¦¬ì— ì ì¬í•œë‹¤.

    - ìë°”ì—ì„œ í´ë˜ìŠ¤ ë¡œë”©ì€ ë™ì ìœ¼ë¡œ ì¼ì–´ë‚œë‹¤. ë™ì  í´ë˜ìŠ¤ ë¡œë”©ì—ëŠ” 1) ë¡œë“œíƒ€ì„ ë™ì  ë¡œë”©(load-time dynamic loading)ê³¼ 2) ëŸ°íƒ€ì„ ë™ì  ë¡œë”©(runtime dynamic loading)ì´ ìˆë‹¤.

      1) ë¡œë“œíƒ€ì„ ë™ì  ë¡œë”©: **í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë¥¼ ë¡œë”©í•˜ëŠ” ê³¼ì •ì—ì„œ** í•´ë‹¹ í´ë˜ìŠ¤ì™€ ê´€ë ¨ëœ í´ë˜ìŠ¤ë¥¼ ë¡œë”©í•˜ëŠ” ê²ƒ

      ```java
      package com.quriemoon.practiceSE;
      
      public class PracticeApplication {
      	public static void main(String[] args) {
      		System.out.println("Hi");
      	}
      }
      ```

      - ìœ„ ìë°” ì†ŒìŠ¤ì½”ë“œë¥¼ ì»´íŒŒì¼í•œ í›„ì— ì‹¤í–‰ ì‹œ, ì•„ë˜ í´ë˜ìŠ¤ë“¤ì´ ë¡œë“œíƒ€ì„ì— ë™ì ìœ¼ë¡œ ë¡œë”©ëœë‹¤.

        ```
        java.lang.String
        java.lang.System
        ```

      2) ëŸ°íƒ€ì„ ë™ì  ë¡œë”©: **ë©”ì†Œë“œê°€ ì‹¤í–‰ë  ë•Œ,** í´ë˜ìŠ¤ë¥¼ ë¡œë”©í•˜ëŠ” ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤.

      - ì•„ë˜ í¬ìŠ¤íŠ¸ì—ì„œ ëŸ°íƒ€ì„ ë™ì  ë¡œë”©ì˜ ì˜ˆì‹œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. (RuntimeLoading í´ë˜ìŠ¤ ë¶€ë¶„)

        [ìë°”ìº”(Java Can Do IT) - í´ë˜ìŠ¤ë¡œë” 1, ë™ì ì¸ í´ë˜ìŠ¤ ë¡œë”©ê³¼ í´ë˜ìŠ¤ë¡œë”](https://javacan.tistory.com/entry/1)

    - JVM class loaderì—ëŠ” 3ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤.

      1. Bootstrap ClassLoader
         - ìµœìƒìœ„ classloaderë¡œ, `java.lang` íŒ¨í‚¤ì§€ì™€ ê°™ì€ javaì˜ ê¸°ë³¸ í´ë˜ìŠ¤ë“¤ì„ ë‹´ê³  ìˆëŠ” `rt.jar` íŒŒì¼ì„ ë¡œë”©í•œë‹¤.
      2. Extension ClassLoader
         - BootStrap Classloaderì˜ ìì† í´ë˜ìŠ¤ì— í•´ë‹¹í•˜ë©°, `*$JAVA_HOME/jre/lib/ext` ì— ìˆëŠ” jar íŒŒì¼ì„ ë¡œë”©í•œë‹¤.
      3. System/Application ClassLoader
         - Extension Classloaderì˜ ìì† í´ë˜ìŠ¤ë¡œ, classpathì— ìˆëŠ” í´ë˜ìŠ¤íŒŒì¼ì„ ì½ì–´ì˜¨ë‹¤.

    2) Runtime Data Area

    - JVMì´ OS ìœ„ì— ì‹¤í–‰ë˜ë©´ì„œ í• ë‹¹ë°›ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ìœ¼ë¡œ, class loaderì—ì„œ ì˜¬ë¦° ë°ì´í„°ë“¤ì´ ë³´ê´€ë˜ëŠ” ê³³ì´ë‹¤.
    - [Runtime Data Area êµ¬ì„± ìƒì„¸ ì„¤ëª… ì°¸ê³  ë§í¬](https://velog.io/@dnjscksdn98/Java-What-is-JVM)

    3) Execution Engine

    - Runtime Data Areaì— ë°°ì¹˜ëœ ìë°” ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ ì‹¤í–‰í•œë‹¤.
    - Execution Engineì˜ êµ¬ì„±
      1. A virtual processor
      2. Interpreter
         - ë°”ì´íŠ¸ì½”ë“œë¥¼ ì½ì–´ì™€ì„œ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•œë‹¤.
      3. Just-In-Time(JIT) compiler
         - í¼í¬ë¨¼ìŠ¤ í–¥ìƒì„ ìœ„í•œ ë¶€ë¶„

    4) Garbage Collector

    - Runtime Data Area ë‚´ Heap ë©”ëª¨ë¦¬ ì˜ì—­ì—ì„œ ë” ì´ìƒ Stack Areaì—ì„œ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë“¤ì„ ì œê±°í•œë‹¤.

- ë°”ì´íŠ¸ì½”ë“œë€ ë¬´ì—‡ì¸ê°€

  - Java ì†ŒìŠ¤ì½”ë“œê°€ ì»´íŒŒì¼ë˜ì—ˆì„ ë•Œ ìƒê¸°ëŠ” ê²°ê³¼ë¬¼ë¡œ, JVMì´ ì‹¤ì œë¡œ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œì´ë‹¤.

    ![JVM Bytecode](https://d1jnx9ba8s6j9r.cloudfront.net/blog/wp-content/uploads/2019/08/2019-08-22-11_54_57-Window.png)

    > ê·¸ë¦¼ ì¶œì²˜ : [edureka! - What is Bytecode in java and how it works?](https://www.edureka.co/blog/java-bytecode/)

- JIT ì»´íŒŒì¼ëŸ¬ë€ ë¬´ì—‡ì´ë©° ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€

  - JIT ì»´íŒŒì¼ëŸ¬ëŠ” **run timeì—** java ë°”ì´íŠ¸ì½”ë“œ(`.class`)ë¥¼ native machine codeë¡œ ë°”ê¿”ë†“ëŠ”ë‹¤.
    ì´ë ‡ê²Œ JIT ì„ í†µí•´ì„œ ì»´íŒŒì¼ëœ ë©”ì†Œë“œëŠ” ì´í›„ì— JVMì—ì„œ í•´ì„(interpret)ë˜ëŠ” ê³¼ì • ì—†ì´ ë°”ë¡œ í˜¸ì¶œëœë‹¤.

  - JIT ì»´íŒŒì¼ëŸ¬ê°€ ë™ì‘í•˜ëŠ” ê³¼ì •ì€ ì•„ë˜ ìˆœì„œë„ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

    ![JIT compiler process](https://docs.oracle.com/cd/E19455-01/806-3461/images/nancb4.eps.gif)

    í•˜ì§€ë§Œ, ëª¨ë“  ë©”ì†Œë“œê°€ JIT ì»´íŒŒì¼ëŸ¬ë¥¼ í†µí•´ì„œ ì»´íŒŒì¼ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

    OpenJ9ì— ë”°ë¥´ë©´, ê° ë©”ì†Œë“œë³„ë¡œ í˜¸ì¶œë˜ëŠ” íšŸìˆ˜ë¥¼ ê¸°ë¡í•œ í›„ì— íŠ¹ì • ë©”ì†Œë“œê°€ ì‚¬ì „ì— ì •ì˜ëœ ì„ê³„ê°’(threshold)ë¥¼ ë„˜ëŠ” ê²½ìš°ì—ë§Œ JIT ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ì»´íŒŒì¼ëœë‹¤.

  - JIT ì»´íŒŒì¼ëŸ¬ì˜ ì¥ì 

    - JIT ì»´íŒŒì¼ëŸ¬ê°€ ì—†ë‹¤ë©´ ë§¤ë²ˆ JVM ìŠ¤ìŠ¤ë¡œ ì¶”ê°€ì ì¸ CPUì™€ ë©”ëª¨ë¦¬ ìì›ì„ í™œìš©í•˜ì—¬, java ë°”ì´íŠ¸ì½”ë“œë¥¼ í•´ì„í•´ì•¼í•œë‹¤. í•˜ì§€ë§Œ, JIT ì»´íŒŒì¼ëŸ¬ ë•ë¶„ì— ì´ëŸ¬í•œ ë¶€ë¶„ì´ ì¤„ì–´ë“¤ë©´ì„œ java ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì´ í–¥ìƒë˜ì—ˆë‹¤.

- JDKì™€ JREì˜ ì°¨ì´

  - JRE(Java Runtime Environment)

    - JREëŠ” ìë°” í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•œ í™˜ê²½ì´ë‹¤.

    - JREëŠ” JVMì´ java ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ë•Œ, í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ íŒŒì¼ë“¤ê³¼ ê¸°íƒ€ íŒŒì¼ë“¤ì„ ê°€ì§€ê³  ìˆë‹¤.

      ![JRE](http://wikidocs.net/images/page/257/jre.jpg)

  - JDK(Java Development Kit)

    - JDKëŠ” ìë°” ê°œë°œë„êµ¬ë¡œ, JRE + ğœ¶ (javac ë“±)ì´ë‹¤. 

      ![JDK](http://wikidocs.net/images/page/257/jdk.jpg)






------

- ì°¸ê³  ìë£Œ

  - ì±… - Javaì˜ ì •ì„(ë‚¨ê¶ì„± ì§€ìŒ)
  - [ìœ„í‚¤í”¼ë””ì•„ - ìë°” ê°€ìƒ ë¨¸ì‹ ](https://ko.wikipedia.org/wiki/%EC%9E%90%EB%B0%94_%EA%B0%80%EC%83%81_%EB%A8%B8%EC%8B%A0)
  - [dnjscksdn98.log - [Java] What is JVM?](https://velog.io/@dnjscksdn98/Java-What-is-JVM)
  - [ìë°”ìº”(Java Can Do IT) - í´ë˜ìŠ¤ë¡œë” 1, ë™ì ì¸ í´ë˜ìŠ¤ ë¡œë”©ê³¼ í´ë˜ìŠ¤ë¡œë”](https://javacan.tistory.com/entry/1)
  - [javatpoint - JVM (Java Virtual Machine) Architecture](https://www.javatpoint.com/jvm-java-virtual-machine)
  - [edureka! - What is Bytecode in java and how it works?](https://www.edureka.co/blog/java-bytecode/)
  - [OpenJ9 - The JIT compiler](https://www.eclipse.org/openj9/docs/jit/)
  - [Oracle - JRE - JIT compiler process](https://docs.oracle.com/cd/E19455-01/806-3461/6jck06gqd/index.html)
  - [ì í”„ íˆ¬ ìë°” - B. JVM, JRE, JDKì˜ ì°¨ì´](https://wikidocs.net/257)

